{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://mission-control.local/schemas/holdings.schema.json",
  "title": "Portfolio Holdings",
  "description": "Schema for portfolio positions including stocks, options, cash, and miscellaneous assets",
  "type": "object",
  "required": ["version", "last_updated", "accounts"],
  "properties": {
    "version": {
      "type": "string",
      "description": "Schema version (e.g., '2.0')",
      "pattern": "^\\d+\\.\\d+$",
      "examples": ["2.0"]
    },
    "last_updated": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of last update (e.g., '2026-02-15T22:02:38.310317')"
    },
    "accounts": {
      "type": "object",
      "description": "Map of account names to their holdings",
      "additionalProperties": {
        "$ref": "#/definitions/account"
      },
      "examples": {
        "Robinhood": { "stocks": [], "options": [], "cash": [], "misc": [] },
        "SEP-IRA": { "stocks": [], "options": [], "cash": [], "misc": [] }
      }
    }
  },
  "definitions": {
    "account": {
      "type": "object",
      "required": ["stocks", "options", "cash", "misc"],
      "properties": {
        "stocks": {
          "type": "array",
          "description": "Array of stock/ETF positions",
          "items": { "$ref": "#/definitions/stockPosition" }
        },
        "options": {
          "type": "array",
          "description": "Array of options positions",
          "items": { "$ref": "#/definitions/optionsPosition" }
        },
        "cash": {
          "type": "array",
          "description": "Array of cash and cash equivalent positions",
          "items": { "$ref": "#/definitions/cashPosition" }
        },
        "misc": {
          "type": "array",
          "description": "Array of miscellaneous assets (crypto, etc.)",
          "items": { "$ref": "#/definitions/miscPosition" }
        }
      }
    },
    "stockPosition": {
      "type": "object",
      "required": ["ticker", "shares", "cost_basis"],
      "properties": {
        "ticker": {
          "type": "string",
          "minLength": 1,
          "maxLength": 10,
          "pattern": "^[A-Z0-9\\.]+$",
          "description": "Stock ticker symbol (e.g., 'AAPL', 'BRK.B')"
        },
        "shares": {
          "type": "number",
          "minimum": 0,
          "description": "Number of shares held (supports fractional shares)"
        },
        "cost_basis": {
          "type": "number",
          "minimum": 0,
          "description": "Total cost basis in USD (e.g., 19783.84)"
        },
        "notes": {
          "type": "string",
          "maxLength": 500,
          "description": "Optional notes about the position"
        }
      }
    },
    "optionsPosition": {
      "type": "object",
      "required": ["ticker", "type", "strike", "expiration", "contracts", "entry_premium"],
      "properties": {
        "ticker": {
          "type": "string",
          "minLength": 1,
          "maxLength": 10,
          "pattern": "^[A-Z0-9]+$",
          "description": "Underlying stock ticker (e.g., 'AAPL')"
        },
        "type": {
          "type": "string",
          "enum": ["CALL", "PUT"],
          "description": "Option type: CALL or PUT"
        },
        "strike": {
          "type": "string",
          "pattern": "^\\$?[0-9]+\\.?[0-9]*$",
          "description": "Strike price as string (e.g., '$150.00' or '150')"
        },
        "expiration": {
          "type": "string",
          "format": "date",
          "description": "Option expiration date (YYYY-MM-DD format)"
        },
        "contracts": {
          "type": "integer",
          "description": "Number of contracts (negative for short positions)"
        },
        "entry_premium": {
          "type": "number",
          "minimum": 0,
          "description": "Premium paid/received per contract (e.g., 4.50 for $450 per contract)"
        }
      }
    },
    "cashPosition": {
      "type": "object",
      "required": ["asset", "quantity"],
      "properties": {
        "asset": {
          "type": "string",
          "enum": ["Cash", "SGOV"],
          "description": "Cash or cash equivalent identifier"
        },
        "quantity": {
          "type": "number",
          "minimum": 0,
          "description": "Cash amount in USD or number of SGOV shares"
        },
        "cost_basis": {
          "type": "number",
          "minimum": 0,
          "description": "Cost basis (for SGOV) or 0 for cash"
        },
        "category": {
          "type": "string",
          "enum": ["cash", "money_market", "treasury"],
          "description": "Category of cash equivalent"
        }
      }
    },
    "miscPosition": {
      "type": "object",
      "required": ["asset", "amount", "type"],
      "properties": {
        "asset": {
          "type": "string",
          "minLength": 1,
          "maxLength": 10,
          "description": "Asset identifier (e.g., 'ETH', 'BTC')"
        },
        "amount": {
          "type": "number",
          "minimum": 0,
          "description": "Amount/units of the asset (e.g., 11.43 ETH)"
        },
        "type": {
          "type": "string",
          "enum": ["Crypto", "Commodity", "Collectible", "Other"],
          "description": "Type of miscellaneous asset"
        },
        "cost_basis": {
          "type": "number",
          "minimum": 0,
          "description": "Total cost basis in USD"
        }
      }
    }
  }
}
